{% extends "base_3d.html" %}

{% block title %}Home - 3D Asset Manager{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="gradient-bg text-white py-20">
    <div class="max-w-7xl mx-auto px-4 text-center">
        <h1 class="text-5xl font-bold mb-6">Professional 3D Asset Management</h1>
        <p class="text-xl mb-8 text-indigo-100">Upload, share, and download 3D models with ease. Support for all major formats.</p>
        <div class="space-x-4">
            {% if not current_user.is_authenticated %}
                <a href="{{ url_for('auth.register') }}" class="bg-white text-indigo-600 px-8 py-3 rounded-lg font-semibold hover:bg-gray-100">Get Started</a>
                <a href="{{ url_for('main.browse') }}" class="border-2 border-white text-white px-8 py-3 rounded-lg font-semibold hover:bg-white hover:text-indigo-600">Browse Models</a>
            {% else %}
                <a href="{{ url_for('main.upload') }}" class="bg-white text-indigo-600 px-8 py-3 rounded-lg font-semibold hover:bg-gray-100">Upload Model</a>
                <a href="{{ url_for('main.dashboard') }}" class="border-2 border-white text-white px-8 py-3 rounded-lg font-semibold hover:bg-white hover:text-indigo-600">Dashboard</a>
            {% endif %}
        </div>
    </div>
</section>

<!-- Stats Section -->
<section class="py-16">
    <div class="max-w-7xl mx-auto px-4">
        <div class="grid md:grid-cols-3 gap-8 text-center">
            <div class="bg-white p-8 rounded-xl card-shadow">
                <div class="text-4xl font-bold text-indigo-600 mb-2">{{ total_models }}</div>
                <div class="text-gray-600">3D Models</div>
            </div>
            <div class="bg-white p-8 rounded-xl card-shadow">
                <div class="text-4xl font-bold text-green-600 mb-2">{{ total_users }}</div>
                <div class="text-gray-600">Active Users</div>
            </div>
            <div class="bg-white p-8 rounded-xl card-shadow">
                <div class="text-4xl font-bold text-purple-600 mb-2">8</div>
                <div class="text-gray-600">Supported Formats</div>
            </div>
        </div>
    </div>
</section>

<!-- Features Section -->
<section class="bg-white py-16">
    <div class="max-w-7xl mx-auto px-4">
        <h2 class="text-3xl font-bold text-center mb-12">Powerful Features</h2>
        <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
            <div class="text-center group">
                <div class="bg-gradient-to-br from-indigo-100 to-indigo-200 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4 transform group-hover:scale-110 transition duration-300 shadow-lg feature-icon-container upload-diagram">
                    <!-- Upload Diagram: Computer with Upload Arrow -->
                    <svg viewBox="0 0 24 24" class="w-8 h-8 text-indigo-600" fill="currentColor">
                        <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                        <path d="M12,11L16,15H13V19H11V15H8L12,11Z" fill="#4f46e5" opacity="0.8"/>
                    </svg>
                </div>
                <h3 class="text-lg font-semibold mb-2 text-indigo-700">Easy Upload</h3>
                <p class="text-gray-600">Drag and drop your 3D models with instant processing</p>
            </div>
            <div class="text-center group">
                <div class="bg-gradient-to-br from-green-100 to-green-200 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4 transform group-hover:scale-110 transition duration-300 shadow-lg feature-icon-container download-diagram">
                    <!-- Download Diagram: Cloud with Download Arrow -->
                    <svg viewBox="0 0 24 24" class="w-8 h-8 text-green-600" fill="currentColor">
                        <path d="M17,13L12,18L7,13H10V9H14V13M19.35,10.03C18.67,6.59 15.64,4 12,4C9.11,4 6.6,5.64 5.35,8.03C2.34,8.36 0,10.9 0,14A6,6 0 0,0 6,20H19A5,5 0 0,0 24,15C24,12.36 21.95,10.22 19.35,10.03Z"/>
                        <path d="M12,13L16,17H13V21H11V17H8L12,13Z" fill="#10b981" opacity="0.9"/>
                    </svg>
                </div>
                <h3 class="text-lg font-semibold mb-2 text-green-700">Fast Download</h3>
                <p class="text-gray-600">Download models instantly via web or API</p>
            </div>
            <div class="text-center group">
                <div class="bg-gradient-to-br from-purple-100 to-purple-200 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4 transform group-hover:scale-110 transition duration-300 shadow-lg feature-icon-container api-diagram">
                    <!-- API Diagram: Connected Nodes Network -->
                    <svg viewBox="0 0 24 24" class="w-8 h-8 text-purple-600" fill="currentColor">
                        <path d="M12,2A2,2 0 0,1 14,4A2,2 0 0,1 12,6A2,2 0 0,1 10,4A2,2 0 0,1 12,2M21,9V7L15,1H5C3.89,1 3,1.89 3,3V21A2,2 0 0,0 5,23H19A2,2 0 0,0 21,21V9M19,9H14V4H19V9M12,13L8,17H11V21H13V17H16L12,13Z"/>
                        <circle cx="6" cy="6" r="1.5" fill="#8b5cf6" opacity="0.7"/>
                        <circle cx="18" cy="6" r="1.5" fill="#8b5cf6" opacity="0.7"/>
                        <circle cx="6" cy="18" r="1.5" fill="#8b5cf6" opacity="0.7"/>
                        <circle cx="18" cy="18" r="1.5" fill="#8b5cf6" opacity="0.7"/>
                        <line x1="6" y1="6" x2="18" y2="6" stroke="#8b5cf6" stroke-width="0.5" opacity="0.5"/>
                        <line x1="6" y1="18" x2="18" y2="18" stroke="#8b5cf6" stroke-width="0.5" opacity="0.5"/>
                        <line x1="6" y1="6" x2="6" y2="18" stroke="#8b5cf6" stroke-width="0.5" opacity="0.5"/>
                        <line x1="18" y1="6" x2="18" y2="18" stroke="#8b5cf6" stroke-width="0.5" opacity="0.5"/>
                    </svg>
                </div>
                <h3 class="text-lg font-semibold mb-2 text-purple-700">RESTful API</h3>
                <p class="text-gray-600">Full API access for developers and integrations</p>
            </div>
            <div class="text-center group">
                <div class="bg-gradient-to-br from-orange-100 to-orange-200 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4 transform group-hover:scale-110 transition duration-300 shadow-lg feature-icon-container security-diagram">
                    <!-- Security Diagram: Shield with Lock -->
                    <svg viewBox="0 0 24 24" class="w-8 h-8 text-orange-600" fill="currentColor">
                        <path d="M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M12,7C13.4,7 14.8,8.6 14.8,10V11H16V18H8V11H9.2V10C9.2,8.6 10.6,7 12,7M12,8.2C11.2,8.2 10.4,8.7 10.4,10V11H13.6V10C13.6,8.7 12.8,8.2 12,8.2Z"/>
                        <circle cx="12" cy="14.5" r="1.5" fill="#f59e0b" opacity="0.8"/>
                        <rect x="11" y="15.5" width="2" height="1" fill="#f59e0b" opacity="0.8"/>
                    </svg>
                </div>
                <h3 class="text-lg font-semibold mb-2 text-orange-700">Secure Storage</h3>
                <p class="text-gray-600">Your models are safely stored with privacy controls</p>
            </div>
        </div>
    </div>
</section>

<!-- Recent Models -->
{% if recent_models %}
<section class="py-16">
    <div class="max-w-7xl mx-auto px-4">
        <h2 class="text-3xl font-bold text-center mb-12">Recent Models</h2>
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
            {% for model in recent_models %}
            <div class="bg-white rounded-xl card-shadow hover-scale overflow-hidden">
                <!-- 3D Preview for Recent Models -->
                <div class="h-48 relative">
                    <div id="viewer-recent-{{ model.id }}" class="model-viewer">
                        <div class="viewer-loading">
                            <div class="text-center">
                                <div class="text-3xl text-gray-400 mb-2">🎨</div>
                                <p class="text-gray-600 text-xs">{{ model.file_format.upper() }} Model</p>
                                <button onclick="loadRecentModel('{{ model.id }}')" 
                                        class="mt-2 bg-indigo-600 text-white px-3 py-1 rounded text-xs hover:bg-indigo-700">
                                    Load Preview
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="p-6">
                    <h3 class="text-lg font-semibold mb-2">{{ model.name }}</h3>
                    <p class="text-gray-600 text-sm mb-3">
                        {% if model.description %}
                            {% if model.description|length > 100 %}
                                {{ model.description[:100] }}...
                            {% else %}
                                {{ model.description }}
                            {% endif %}
                        {% endif %}
                    </p>
                    <div class="flex justify-between items-center text-sm text-gray-500">
                        <span>by {{ model.owner_username or 'Unknown' }}</span>
                        <span>{{ model.download_count }} downloads</span>
                    </div>
                    <div class="mt-4">
                        <a href="{{ url_for('main.model_detail', model_id=model.id) }}" 
                           class="bg-indigo-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-indigo-700">
                            View Details
                        </a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        <div class="text-center mt-8">
            <a href="{{ url_for('main.browse') }}" class="bg-indigo-600 text-white px-8 py-3 rounded-lg hover:bg-indigo-700">
                Browse All Models
            </a>
        </div>
    </div>
</section>

<script>
const loadedRecentViewers = new Set();

function loadRecentModel(modelId) {
    if (loadedRecentViewers.has(modelId)) return;
    
    loadedRecentViewers.add(modelId);
    const container = document.getElementById(`viewer-recent-${modelId}`);
    
    try {
        createModelViewer(`viewer-recent-${modelId}`, modelId, {
            width: container.clientWidth,
            height: container.clientHeight
        });
    } catch (error) {
        console.error('Failed to load recent model:', error);
        container.innerHTML = '<div class="viewer-error"><div class="text-2xl">⚠️</div><div class="text-xs">Preview unavailable</div></div>';
    }
}

// Auto-load first recent model on page load
document.addEventListener('DOMContentLoaded', function() {
    const recentViewers = document.querySelectorAll('[id^="viewer-recent-"]');
    if (recentViewers.length > 0) {
        const firstModelId = recentViewers[0].id.replace('viewer-recent-', '');
        setTimeout(() => loadRecentModel(firstModelId), 1000);
    }
});
</script>
{% endif %}

<!-- API Demo Section -->
<section class="bg-gradient-to-br from-gray-50 to-blue-50 py-16">
    <div class="max-w-7xl mx-auto px-4">
        <div class="text-center mb-12">
            <h2 class="text-4xl font-bold mb-4 bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">Developer Friendly</h2>
            <p class="text-gray-600 text-lg">Full RESTful API for seamless integration</p>
        </div>
        
        <div class="grid lg:grid-cols-2 gap-8 mb-12">
            <!-- API Endpoints -->
            <div class="bg-white rounded-xl card-shadow p-8 border-l-4 border-blue-500">
                <h3 class="text-2xl font-semibold mb-6 text-blue-700">
                    <i class="fas fa-code mr-2"></i>API Endpoints
                </h3>
                <div class="space-y-4">
                    <div class="flex items-center space-x-4 p-3 bg-green-50 rounded-lg">
                        <span class="bg-green-500 text-white px-3 py-1 rounded-full text-sm font-bold">GET</span>
                        <code class="text-gray-800 font-mono bg-gray-100 px-2 py-1 rounded">/api/models</code>
                        <span class="text-green-600 text-sm">List models</span>
                    </div>
                    <div class="flex items-center space-x-4 p-3 bg-blue-50 rounded-lg">
                        <span class="bg-blue-500 text-white px-3 py-1 rounded-full text-sm font-bold">POST</span>
                        <code class="text-gray-800 font-mono bg-gray-100 px-2 py-1 rounded">/api/upload</code>
                        <span class="text-blue-600 text-sm">Upload model</span>
                    </div>
                    <div class="flex items-center space-x-4 p-3 bg-green-50 rounded-lg">
                        <span class="bg-green-500 text-white px-3 py-1 rounded-full text-sm font-bold">GET</span>
                        <code class="text-gray-800 font-mono bg-gray-100 px-2 py-1 rounded">/api/download/{id}</code>
                        <span class="text-green-600 text-sm">Download</span>
                    </div>
                    <div class="flex items-center space-x-4 p-3 bg-red-50 rounded-lg">
                        <span class="bg-red-500 text-white px-3 py-1 rounded-full text-sm font-bold">DEL</span>
                        <code class="text-gray-800 font-mono bg-gray-100 px-2 py-1 rounded">/api/model/{id}</code>
                        <span class="text-red-600 text-sm">Delete model</span>
                    </div>
                </div>
            </div>

            <!-- Supported Formats -->
            <div class="bg-white rounded-xl card-shadow p-8 border-l-4 border-purple-500">
                <h3 class="text-2xl font-semibold mb-6 text-purple-700">
                    <i class="fas fa-cube mr-2"></i>Supported Formats
                </h3>
                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-gradient-to-br from-indigo-50 to-indigo-100 p-4 rounded-lg text-center border border-indigo-200">
                        <i class="fas fa-cube text-3xl text-indigo-600 mb-2"></i>
                        <div class="text-lg font-bold text-indigo-700">OBJ</div>
                        <div class="text-xs text-indigo-500">Wavefront</div>
                    </div>
                    <div class="bg-gradient-to-br from-purple-50 to-purple-100 p-4 rounded-lg text-center border border-purple-200">
                        <i class="fas fa-cubes text-3xl text-purple-600 mb-2"></i>
                        <div class="text-lg font-bold text-purple-700">FBX</div>
                        <div class="text-xs text-purple-500">Autodesk</div>
                    </div>
                    <div class="bg-gradient-to-br from-green-50 to-green-100 p-4 rounded-lg text-center border border-green-200">
                        <i class="fas fa-project-diagram text-3xl text-green-600 mb-2"></i>
                        <div class="text-lg font-bold text-green-700">GLTF</div>
                        <div class="text-xs text-green-500">Khronos</div>
                    </div>
                    <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-4 rounded-lg text-center border border-blue-200">
                        <i class="fas fa-file-archive text-3xl text-blue-600 mb-2"></i>
                        <div class="text-lg font-bold text-blue-700">GLB</div>
                        <div class="text-xs text-blue-500">Binary GLTF</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- CLI Examples -->
        <div class="bg-gray-900 rounded-xl p-8 text-white">
            <h3 class="text-2xl font-semibold mb-6 text-center">
                <i class="fas fa-terminal mr-2"></i>CLI Examples
            </h3>
            
            <div class="grid md:grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Login -->
                <div class="bg-gray-800 rounded-lg p-6">
                    <h4 class="text-lg font-semibold mb-3 text-blue-400">
                        <i class="fas fa-sign-in-alt mr-2"></i>1. Login
                    </h4>
                    <pre class="text-sm text-green-400 bg-gray-900 p-3 rounded overflow-x-auto"><code># Login to get session
curl -X POST https://your-project.vercel.app/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "user@example.com",
    "password": "your_password"
  }' \
  -c cookies.txt</code></pre>
                </div>

                <!-- Upload -->
                <div class="bg-gray-800 rounded-lg p-6">
                    <h4 class="text-lg font-semibold mb-3 text-purple-400">
                        <i class="fas fa-upload mr-2"></i>2. Upload Model
                    </h4>
                    <pre class="text-sm text-green-400 bg-gray-900 p-3 rounded overflow-x-auto"><code># Upload a 3D model
curl -X POST https://your-project.vercel.app/api/upload \
  -b cookies.txt \
  -F "file=@model.glb" \
  -F "name=My Keyboard" \
  -F "description=Gaming keyboard model" \
  -F "is_public=true"</code></pre>
                </div>

                <!-- Download -->
                <div class="bg-gray-800 rounded-lg p-6">
                    <h4 class="text-lg font-semibold mb-3 text-orange-400">
                        <i class="fas fa-download mr-2"></i>3. Download Model
                    </h4>
                    <pre class="text-sm text-green-400 bg-gray-900 p-3 rounded overflow-x-auto"><code># Download model by ID
curl -X GET https://your-project.vercel.app/api/download/1 \
  -b cookies.txt \
  -o downloaded_model.glb

# Or browse public models
curl https://your-project.vercel.app/api/models</code></pre>
                </div>
            </div>

            <!-- Additional Examples -->
            <div class="mt-8 bg-gray-800 rounded-lg p-6">
                <h4 class="text-lg font-semibold mb-4 text-yellow-400">
                    <i class="fas fa-lightbulb mr-2"></i>Advanced Usage
                </h4>
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <h5 class="text-md font-semibold mb-2 text-cyan-400">List Your Models</h5>
                        <pre class="text-sm text-green-400 bg-gray-900 p-3 rounded overflow-x-auto"><code>curl -X GET https://your-project.vercel.app/api/models?user=me \
  -b cookies.txt</code></pre>
                    </div>
                    <div>
                        <h5 class="text-md font-semibold mb-2 text-pink-400">Delete Model</h5>
                        <pre class="text-sm text-green-400 bg-gray-900 p-3 rounded overflow-x-auto"><code>curl -X DELETE https://your-project.vercel.app/api/model/1 \
  -b cookies.txt</code></pre>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}
